// implementation moved to header for inlining
