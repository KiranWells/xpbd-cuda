// Implementations moved to header for inlining
